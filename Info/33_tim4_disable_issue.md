# 33. Проблема отключения прерываний TIM4: HAL_Delay не работает

## Проблема
Если отключить `HAL_TIM_Base_Start_IT(&htim4);` в `HAL_InitTick()`, проект не запускается без отладчика, потому что `HAL_Delay()` использует `uwTick`, который обновляется только в прерывании TIM4.

Без прерываний `uwTick` не увеличивается, и `HAL_Delay()` зависает или работает неправильно.

## Решение
Обязательно переопределить `HAL_Delay()` в FreeRTOS, чтобы он использовал `osDelay()` вместо `uwTick`.

### Изменения:
1. В `Core/Src/freertos.c`, в разделе `/* USER CODE BEGIN Application */`, добавьте:
```c
void HAL_Delay(uint32_t Delay)
{
  osDelay(Delay);
}
```

2. Затем отключите прерывания TIM4: закомментируйте `HAL_TIM_Base_Start_IT(&htim4);` в `stm32f4xx_hal_timebase_tim.c`.

### Почему это работает:
- `osDelay()` использует SysTick от FreeRTOS, который работает.
- `HAL_Delay()` теперь вызывает `osDelay()`, поэтому задержки работают корректно.
- Прерывания TIM4 отключены, отладчик не останавливается.

### Альтернатива:
Если не отключать прерывания, снизьте приоритет TIM4 до 15, как в `Info/32_changes_needed.md`.

## Заключение
Отключение прерываний TIM4 требует переопределения `HAL_Delay()`, иначе проект не запустится. Используйте `osDelay()` для всех задержек в FreeRTOS.
